# –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

## ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –∑–∞—â–∏—Ç–∞

### 1. CSRF Protection
- ‚úÖ Flask-WTF CSRF —Ç–æ–∫–µ–Ω—ã –Ω–∞ –≤—Å–µ—Ö —Ñ–æ—Ä–º–∞—Ö
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è —Ç–æ–∫–µ–Ω–æ–≤
- ‚úÖ SameSite cookies

### 2. XSS Protection
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ Jinja2
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ –≤–≤–æ–¥–∞
- ‚úÖ –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–ª–∏–Ω—ã –∫–æ–Ω—Ç–µ–Ω—Ç–∞

### 3. SQL Injection
- ‚úÖ SQLAlchemy ORM (–ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã)
- ‚úÖ –ù–µ—Ç raw SQL –∑–∞–ø—Ä–æ—Å–æ–≤

### 4. Authentication & Sessions
- ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π (pbkdf2:sha256)
- ‚úÖ –†–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è session ID –ø–æ—Å–ª–µ –ª–æ–≥–∏–Ω–∞
- ‚úÖ HttpOnly cookies
- ‚úÖ Secure cookies (–≤ production —Å HTTPS)
- ‚úÖ Session timeout (7 –¥–Ω–µ–π)

### 5. File Upload Security
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è —Ñ–∞–π–ª–∞
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ MIME-type
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ —á–µ—Ä–µ–∑ Pillow
- ‚úÖ –ó–∞—â–∏—Ç–∞ –æ—Ç decompression bomb
- ‚úÖ –£–¥–∞–ª–µ–Ω–∏–µ EXIF –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ (4MB)
- ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω—ã–µ –∏–º–µ–Ω–∞ —Ñ–∞–π–ª–æ–≤ (secure_filename)

### 6. Rate Limiting
- ‚úÖ Login: 5 –ø–æ–ø—ã—Ç–æ–∫ –≤ —á–∞—Å
- ‚úÖ Register: 3 –ø–æ–ø—ã—Ç–∫–∏ –≤ —á–∞—Å
- ‚úÖ Create post: 30 –≤ —á–∞—Å
- ‚úÖ Search: 60 –≤ —á–∞—Å
- ‚úÖ –û–±—â–∏–π –ª–∏–º–∏—Ç: 200/–¥–µ–Ω—å, 50/—á–∞—Å

### 7. Input Validation
- ‚úÖ Username: 3-30 —Å–∏–º–≤–æ–ª–æ–≤, —Ç–æ–ª—å–∫–æ a-z, 0-9, _
- ‚úÖ Password: –º–∏–Ω–∏–º—É–º 6 —Å–∏–º–≤–æ–ª–æ–≤
- ‚úÖ Post content: –º–∞–∫—Å–∏–º—É–º 5000 —Å–∏–º–≤–æ–ª–æ–≤
- ‚úÖ WTForms –≤–∞–ª–∏–¥–∞—Ü–∏—è

### 8. Error Handling
- ‚úÖ –ö–∞—Å—Ç–æ–º–Ω—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –æ—à–∏–±–æ–∫ (403, 404, 500)
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫
- ‚úÖ –ù–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º stack traces –≤ production

### 9. Logging
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π
- ‚úÖ –†–æ—Ç–∞—Ü–∏—è –ª–æ–≥–æ–≤ (10MB x 10 —Ñ–∞–π–ª–æ–≤)
- ‚úÖ –õ–æ–≥–∏ –ø–æ–ø—ã—Ç–æ–∫ –≤—Ö–æ–¥–∞

### 10. Database
- ‚úÖ –ú–∏–≥—Ä–∞—Ü–∏–∏ —á–µ—Ä–µ–∑ Flask-Migrate
- ‚úÖ –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –∏ rollback –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö
- ‚úÖ –ò–Ω–¥–µ–∫—Å—ã –¥–ª—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

## üî¥ –ß—Ç–æ –Ω—É–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –¥–ª—è production

### 1. HTTPS
```python
# –í config.py –¥–ª—è production
SESSION_COOKIE_SECURE = True
PREFERRED_URL_SCHEME = 'https'
```

### 2. Content Security Policy
```python
@app.after_request
def set_csp(response):
    response.headers['Content-Security-Policy'] = "default-src 'self'"
    return response
```

### 3. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
```python
@app.after_request
def set_security_headers(response):
    response.headers['X-Content-Type-Options'] = 'nosniff'
    response.headers['X-Frame-Options'] = 'DENY'
    response.headers['X-XSS-Protection'] = '1; mode=block'
    response.headers['Strict-Transport-Security'] = 'max-age=31536000; includeSubDomains'
    return response
```

### 4. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö Production
–ó–∞–º–µ–Ω–∏—Ç–µ SQLite –Ω–∞ PostgreSQL:
```python
SQLALCHEMY_DATABASE_URI = 'postgresql://user:password@localhost/dbname'
```

### 5. Email –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
- –î–æ–±–∞–≤—å—Ç–µ –ø–æ–ª–µ `email_confirmed` –≤ –º–æ–¥–µ–ª—å User
- –û—Ç–ø—Ä–∞–≤–ª—è–π—Ç–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ email –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
- –¢—Ä–µ–±—É–π—Ç–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –¥–ª—è –¥–æ—Å—Ç—É–ø–∞

### 6. –î–≤—É—Ö—Ñ–∞–∫—Ç–æ—Ä–Ω–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
- –ò–Ω—Ç–µ–≥—Ä–∏—Ä—É–π—Ç–µ TOTP (pyotp)
- –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –≤ –ø—Ä–æ—Ñ–∏–ª–µ

### 7. –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–∞—Ä–æ–ª—è
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –±–µ–∑–æ–ø–∞—Å–Ω—ã—Ö —Ç–æ–∫–µ–Ω–æ–≤
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –¥–µ–π—Å—Ç–≤–∏—è —Ç–æ–∫–µ–Ω–∞
- Email —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

### 8. –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
- –ù–∞—Å—Ç—Ä–æ–π—Ç–µ Sentry –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –æ—à–∏–±–æ–∫
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (New Relic, DataDog)
- –ê–ª–µ—Ä—Ç—ã –Ω–∞ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—É—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å

### 9. –†–µ–≥—É–ª—è—Ä–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è—Ö
pip install safety
safety check

# –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
pip list --outdated
```

### 10. Backup —Å—Ç—Ä–∞—Ç–µ–≥–∏—è
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –±—ç–∫–∞–ø—ã –ë–î (–µ–∂–µ–¥–Ω–µ–≤–Ω–æ)
- –ë—ç–∫–∞–ø –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è

## üö® –£—è–∑–≤–∏–º–æ—Å—Ç–∏, –∫–æ—Ç–æ—Ä—ã–µ –±—ã–ª–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã

### –î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
1. ‚ùå –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ CSRF –∑–∞—â–∏—Ç—ã
2. ‚ùå –°–ª–∞–±—ã–π SECRET_KEY –≤ –∫–æ–¥–µ
3. ‚ùå –ù–µ—Ç rate limiting
4. ‚ùå –ù–µ–±–µ–∑–æ–ø–∞—Å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤
5. ‚ùå –ù–µ—Ç —Ä–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ session ID
6. ‚ùå N+1 –∑–∞–ø—Ä–æ—Å—ã –∫ –ë–î
7. ‚ùå –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –≤–≤–æ–¥–∞
8. ‚ùå –£—Ç–µ—á–∫–∞ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–æ–≤ —Ñ–∞–π–ª–æ–≤
9. ‚ùå –ù–µ—Ç –ø–∞–≥–∏–Ω–∞—Ü–∏–∏
10. ‚ùå –ë–∏—Ç–∞—è –∫–æ–¥–∏—Ä–æ–≤–∫–∞ –≤ —à–∞–±–ª–æ–Ω–∞—Ö

### –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
1. ‚úÖ CSRF —Ç–æ–∫–µ–Ω—ã –≤–µ–∑–¥–µ
2. ‚úÖ SECRET_KEY –≤ .env
3. ‚úÖ Flask-Limiter —Å rate limits
4. ‚úÖ –ü–æ–ª–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–∞–π–ª–æ–≤
5. ‚úÖ session.clear() + regeneration
6. ‚úÖ Eager loading (joinedload)
7. ‚úÖ WTForms + –∫–∞—Å—Ç–æ–º–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è
8. ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å —Ñ–∞–π–ª–∞–º–∏
9. ‚úÖ –ü–∞–≥–∏–Ω–∞—Ü–∏—è –≤–µ–∑–¥–µ
10. ‚úÖ UTF-8 –∫–æ–¥–∏—Ä–æ–≤–∫–∞

## üìã –ß–µ–∫–ª–∏—Å—Ç –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º

- [ ] –ò–∑–º–µ–Ω–µ–Ω SECRET_KEY –Ω–∞ —Å–ª—É—á–∞–π–Ω—ã–π
- [ ] HTTPS –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- [ ] PostgreSQL –≤–º–µ—Å—Ç–æ SQLite
- [ ] Debug mode –≤—ã–∫–ª—é—á–µ–Ω
- [ ] –õ–æ–≥–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –∏ —Ä–æ—Ç–∏—Ä—É—é—Ç—Å—è
- [ ] Rate limiting –≤–∫–ª—é—á–µ–Ω
- [ ] –ë—ç–∫–∞–ø—ã –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã
- [ ] –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- [ ] Firewall –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- [ ] Reverse proxy (nginx) –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- [ ] SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
- [ ] –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –∑–∞—â–∏—â–µ–Ω—ã
- [ ] –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ–±–Ω–æ–≤–ª–µ–Ω—ã
- [ ] –¢–µ—Å—Ç—ã –ø—Ä–æ–π–¥–µ–Ω—ã
- [ ] –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –æ–±–Ω–æ–≤–ª–µ–Ω–∞

## üîç –†–µ–≥—É–ª—è—Ä–Ω—ã–π –∞—É–¥–∏—Ç

### –ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω–æ:
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤ –Ω–∞ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—É—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ failed login attempts
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –¥–∏—Å–∫–∞

### –ï–∂–µ–º–µ—Å—è—á–Ω–æ:
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- `safety check` –¥–ª—è —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –±—ç–∫–∞–ø–æ–≤
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è

### –ï–∂–µ–∫–≤–∞—Ä—Ç–∞–ª—å–Ω–æ:
- –ü–æ–ª–Ω—ã–π security audit
- Penetration testing
- Code review
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏

## üìû –°–æ–æ–±—â–∏—Ç—å –æ–± —É—è–∑–≤–∏–º–æ—Å—Ç–∏

–ï—Å–ª–∏ –≤—ã –Ω–∞—à–ª–∏ —É—è–∑–≤–∏–º–æ—Å—Ç—å:

1. **–ù–ï** —Å–æ–∑–¥–∞–≤–∞–π—Ç–µ –ø—É–±–ª–∏—á–Ω—ã–π issue
2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ email –Ω–∞: security@example.com
3. –û–ø–∏—à–∏—Ç–µ —É—è–∑–≤–∏–º–æ—Å—Ç—å –¥–µ—Ç–∞–ª—å–Ω–æ
4. –ü—Ä–∏–ª–æ–∂–∏—Ç–µ PoC –µ—Å–ª–∏ –≤–æ–∑–º–æ–∂–Ω–æ
5. –ú—ã –æ—Ç–≤–µ—Ç–∏–º –≤ —Ç–µ—á–µ–Ω–∏–µ 48 —á–∞—Å–æ–≤

## üèÜ –ë–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç–∏

–°–ø–∞—Å–∏–±–æ –≤—Å–µ–º, –∫—Ç–æ –ø–æ–º–æ–≥–∞–µ—Ç —É–ª—É—á—à–∞—Ç—å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å!
